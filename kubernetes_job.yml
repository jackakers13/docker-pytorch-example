apiVersion: batch/v1
kind: Job
metadata:
  name: give-your-job-a-name:
  namespace: gp-engine-mizzou-mindful
spec:
  backoffLimit: 0
  completions: 1
  template:
    metadata:
      name: pytorch-training-pod
    spec:
      restartPolicy: Never
      containers:
      - name: pytorch-container--1
        image: gitlab-registry.nrp-nautilus.io/jdapm8/docker-pytorch-example:latest
        command: ["/bin/bash", "-c"]
        # this "args" param is where the start command goes
        args: ["nvidia-smi && cd /root && pwd && ls && python3 ./pytorch_example.py"]
        volumeMounts:
        - name: output-private-volume
          mountPath: /root/host_fs
        resources:
            requests:
              memory: "8Gi"
              cpu: "4"
              nvidia.com/gpu: "1"
            limits:
              memory: "8Gi"
              cpu: "4"
              nvidia.com/gpu: "1"
      volumes:
      - name: output-private-volume
        persistentVolumeClaim:
          claimName: name-of-your-private-volume:
